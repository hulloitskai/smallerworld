#!/usr/bin/env bash

# Format code after making changes
# Usage: bin/cursor_agent_format_code

set -e

echo "üîß Setting up environment..."

# Setup Node.js
export PATH="$HOME/.nodenv/bin:$PATH"
if command -v nodenv >/dev/null 2>&1; then
  eval "$(nodenv init -)"
fi

echo "‚ú® Formatting frontend files (JS/TS/CSS/Markdown)..."
npx prettier --write '**/*.{js,jsx,ts,tsx,css,md,html,json,yaml,yml}' || {
  echo "‚ö†Ô∏è Prettier formatting failed, but continuing..."
}

echo "üßπ Running ESLint auto-fix..."
npx eslint --fix '**/*.{js,jsx,ts,tsx}' || {
  echo "‚ö†Ô∏è ESLint auto-fix failed, but continuing..."
}

echo "üöÄ Running lefthook formatting..."
npx lefthook run fix || {
  echo "‚ö†Ô∏è Lefthook failed, but frontend formatting completed"
}

echo "‚úÖ Formatting complete!"